import{c as M,r as N,j as e,X as L,a as I,R as K}from"./index-DjjC_tOX.js";import{B as u}from"./button-C2gSFW-c.js";import{c as Q,p as Y,u as z,C,d as P,a as B,b as $}from"./language-store-C5mQKX_h.js";import{u as _,G as Z,U as G,l as ee,L as U,e as se,f as ae,g as te,i as re,j as v,B as w,S as le,k as ne,D as R,P as ie}from"./switch-CNhH8Jmz.js";/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],oe=M("list",ce);/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],he=M("settings",de);/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],ge=M("square",me),k={brightness:0,contrast:0,saturation:0,blur:0,sharpen:0,hue:0,gamma:0,vignette:0,sepia:0},pe={natural:{brightness:5,contrast:10,saturation:5,sharpen:15},enhanced:{brightness:10,contrast:20,saturation:15,sharpen:25},dramatic:{brightness:15,contrast:30,saturation:20,sharpen:30,vignette:20},vintage:{sepia:40,contrast:15,vignette:25,saturation:-10},professional:{contrast:25,sharpen:35,brightness:8,gamma:5},mystical:{hue:15,saturation:25,contrast:20,vignette:30,brightness:5}},ue=Q()(Y((n,s)=>({images:[],isProcessing:!1,currentProcessingIndex:0,totalImages:0,completedImages:0,globalFilters:{...k},applyGlobalFilters:!1,selectedPreset:"none",addImages:l=>{const r=l.map((a,t)=>({id:`batch-${Date.now()}-${t}`,file:a,preview:URL.createObjectURL(a),processed:!1,filters:{...k}}));n(a=>({images:[...a.images,...r],totalImages:a.images.length+r.length}))},removeImage:l=>{n(r=>{const a=r.images.find(i=>i.id===l);a!=null&&a.preview&&URL.revokeObjectURL(a.preview),a!=null&&a.downloadUrl&&URL.revokeObjectURL(a.downloadUrl);const t=r.images.filter(i=>i.id!==l);return{images:t,totalImages:t.length,completedImages:Math.min(r.completedImages,t.length)}})},clearBatch:()=>{const{images:l}=s();l.forEach(r=>{r.preview&&URL.revokeObjectURL(r.preview),r.downloadUrl&&URL.revokeObjectURL(r.downloadUrl)}),n({images:[],isProcessing:!1,currentProcessingIndex:0,totalImages:0,completedImages:0})},startBatchProcessing:async()=>{const{images:l,globalFilters:r,applyGlobalFilters:a}=s();n({isProcessing:!0,currentProcessingIndex:0,completedImages:0});for(let t=0;t<l.length;t++){n({currentProcessingIndex:t});const i=l[t],o=a?r:i.filters;try{await new Promise(h=>setTimeout(h,1e3));const d=await xe(i.file,o),x=d.toDataURL("image/png"),m=ve();n(h=>({images:h.images.map(g=>g.id===i.id?{...g,processed:!0,analysis:m,processedCanvas:d,downloadUrl:x,filters:o}:g),completedImages:t+1}))}catch(d){console.error(`Error processing image ${i.id}:`,d)}}n({isProcessing:!1})},stopBatchProcessing:()=>{n({isProcessing:!1})},updateGlobalFilters:l=>{n(r=>({globalFilters:{...r.globalFilters,...l}}))},toggleGlobalFilters:()=>{n(l=>({applyGlobalFilters:!l.applyGlobalFilters}))},applyPresetToBatch:l=>{const r=pe[l]||k;n(a=>({selectedPreset:l,globalFilters:{...k,...r},images:a.images.map(t=>({...t,filters:{...k,...r}}))}))},updateImageFilters:(l,r)=>{n(a=>({images:a.images.map(t=>t.id===l?{...t,filters:{...t.filters,...r}}:t)}))},exportBatch:()=>{const{images:l}=s(),r=l.filter(a=>a.processed);r.length!==0&&r.forEach((a,t)=>{if(a.downloadUrl){const i=document.createElement("a");i.href=a.downloadUrl,i.download=`palm-reading-${t+1}.png`,i.click()}})},reorderImages:(l,r)=>{n(a=>{const t=[...a.images],[i]=t.splice(l,1);return t.splice(r,0,i),{images:t}})}}),{name:"batch-processing-storage",partialize:n=>({globalFilters:n.globalFilters,applyGlobalFilters:n.applyGlobalFilters,selectedPreset:n.selectedPreset})}));async function xe(n,s){return new Promise(l=>{const r=new Image;r.onload=()=>{const a=document.createElement("canvas"),t=a.getContext("2d");a.width=r.width,a.height=r.height;const i=[`brightness(${100+s.brightness}%)`,`contrast(${100+s.contrast}%)`,`saturate(${100+s.saturation}%)`,`blur(${s.blur}px)`,`hue-rotate(${s.hue}deg)`,`sepia(${s.sepia}%)`].join(" ");t.filter=i,t.drawImage(r,0,0),s.sharpen>0&&be(t,a.width,a.height,s.sharpen),s.vignette>0&&fe(t,a.width,a.height,s.vignette),s.gamma!==0&&je(t,a.width,a.height,s.gamma),l(a)},r.src=URL.createObjectURL(n)})}function be(n,s,l,r){const t=n.getImageData(0,0,s,l).data,i=r/100,o=[0,-i,0,-i,1+4*i,-i,0,-i,0],d=new Uint8ClampedArray(t);for(let m=1;m<l-1;m++)for(let h=1;h<s-1;h++)for(let g=0;g<3;g++){let y=0;for(let b=-1;b<=1;b++)for(let f=-1;f<=1;f++){const F=((m+b)*s+(h+f))*4+g;y+=t[F]*o[(b+1)*3+(f+1)]}d[(m*s+h)*4+g]=Math.max(0,Math.min(255,y))}const x=new ImageData(d,s,l);n.putImageData(x,0,0)}function fe(n,s,l,r){const a=n.createRadialGradient(s/2,l/2,0,s/2,l/2,Math.max(s,l)/2),t=r/100;a.addColorStop(0,"rgba(0, 0, 0, 0)"),a.addColorStop(.7,`rgba(0, 0, 0, ${t*.3})`),a.addColorStop(1,`rgba(0, 0, 0, ${t})`),n.globalCompositeOperation="multiply",n.fillStyle=a,n.fillRect(0,0,s,l),n.globalCompositeOperation="source-over"}function je(n,s,l,r){const a=n.getImageData(0,0,s,l),t=a.data,i=1+r/100;for(let o=0;o<t.length;o+=4)t[o]=Math.pow(t[o]/255,1/i)*255,t[o+1]=Math.pow(t[o+1]/255,1/i)*255,t[o+2]=Math.pow(t[o+2]/255,1/i)*255;n.putImageData(a,0,0)}function ve(){const n=["emotion","intelligence","career","energy"],s={};return n.forEach(l=>{s[l]={score:Math.floor(Math.random()*40)+60,description:`Mock ${l} analysis based on palm lines and features.`,confidence:Math.floor(Math.random()*20)+80}}),s}function we(){const{currentLanguage:n,t:s}=z(),{trackEvent:l}=_(),[r,a]=N.useState("grid"),[t,i]=N.useState(!1),{images:o,isProcessing:d,currentProcessingIndex:x,totalImages:m,completedImages:h,globalFilters:g,applyGlobalFilters:y,selectedPreset:b,addImages:f,removeImage:F,clearBatch:E,startBatchProcessing:O,stopBatchProcessing:V,updateGlobalFilters:A,toggleGlobalFilters:q,applyPresetToBatch:T,exportBatch:W,reorderImages:ye}=ue(),S=N.useCallback(c=>{if(!c)return;const p=Array.from(c).filter(j=>j.type.startsWith("image/"));p.length>0&&(f(p),l("batch_images_added",{count:p.length,language:n}))},[f,l,n]),H=N.useCallback(c=>{c.preventDefault(),S(c.dataTransfer.files)},[S]),X=N.useCallback(c=>{c.preventDefault()},[]),J=async()=>{l("batch_processing_started",{imageCount:o.length,applyGlobalFilters:y,selectedPreset:b,language:n}),await O(),l("batch_processing_completed",{imageCount:h,language:n})},D=m>0?h/m*100:0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gradient",children:s("batch.title")}),e.jsx("p",{className:"text-muted-foreground mt-1",children:s("batch.subtitle")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>a(r==="grid"?"list":"grid"),children:r==="grid"?e.jsx(oe,{className:"w-4 h-4"}):e.jsx(Z,{className:"w-4 h-4"})}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>i(!t),children:e.jsx(he,{className:"w-4 h-4"})})]})]}),e.jsx(C,{children:e.jsx(P,{className:"p-6",children:e.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-8 text-center hover:border-primary/50 transition-colors",onDrop:H,onDragOver:X,children:[e.jsx(G,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:s("batch.uploadTitle")}),e.jsx("p",{className:"text-muted-foreground mb-4",children:s("batch.uploadSubtitle")}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:c=>S(c.target.files),className:"hidden",id:"batch-upload"}),e.jsx(u,{asChild:!0,children:e.jsxs("label",{htmlFor:"batch-upload",className:"cursor-pointer",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),s("batch.selectFiles")]})})]})})}),t&&e.jsxs(C,{children:[e.jsx(B,{children:e.jsx($,{children:s("batch.globalSettings")})}),e.jsxs(P,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ee,{id:"global-filters",checked:y,onCheckedChange:q}),e.jsx(U,{htmlFor:"global-filters",children:s("batch.applyGlobalFilters")})]}),y&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(U,{children:s("batch.preset")}),e.jsxs(se,{value:b,onValueChange:T,children:[e.jsx(ae,{children:e.jsx(te,{})}),e.jsxs(re,{children:[e.jsx(v,{value:"none",children:s("filters.none")}),e.jsx(v,{value:"natural",children:s("filters.presets.natural")}),e.jsx(v,{value:"enhanced",children:s("filters.presets.enhanced")}),e.jsx(v,{value:"dramatic",children:s("filters.presets.dramatic")}),e.jsx(v,{value:"vintage",children:s("filters.presets.vintage")}),e.jsx(v,{value:"professional",children:s("filters.presets.professional")}),e.jsx(v,{value:"mystical",children:s("filters.presets.mystical")})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(g).map(([c,p])=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs(U,{className:"flex items-center justify-between",children:[s(`filters.${c}`),e.jsx(w,{variant:"secondary",className:"ml-2",children:p})]}),e.jsx(le,{value:[p],onValueChange:([j])=>A({[c]:j}),min:c==="blur"?0:-50,max:50,step:1,className:"filter-slider"})]},c))})]})]})]}),o.length>0&&e.jsx(C,{children:e.jsxs(P,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(w,{variant:"outline",children:[o.length," ",s("batch.images")]}),d&&e.jsxs(w,{variant:"secondary",children:[s("batch.processing")," ",x+1,"/",m]}),h>0&&!d&&e.jsxs(w,{variant:"default",className:"bg-green-500",children:[h," ",s("batch.completed")]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[d?e.jsxs(u,{variant:"destructive",onClick:V,children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),s("batch.stopProcessing")]}):e.jsxs(u,{onClick:J,disabled:o.length===0,children:[e.jsx(ne,{className:"w-4 h-4 mr-2"}),s("batch.startProcessing")]}),e.jsxs(u,{variant:"outline",onClick:W,disabled:h===0,children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),s("batch.exportAll")]}),e.jsxs(u,{variant:"outline",onClick:E,children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),s("batch.clearAll")]})]})]}),d&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:s("batch.progress")}),e.jsxs("span",{children:[Math.round(D),"%"]})]}),e.jsx(ie,{value:D,className:"h-2"})]})]})}),o.length>0&&e.jsxs(C,{children:[e.jsx(B,{children:e.jsx($,{children:s("batch.imageList")})}),e.jsx(P,{children:e.jsx("div",{className:I("gap-4",r==="grid"?"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4":"space-y-4"),children:o.map((c,p)=>e.jsxs("div",{className:I("relative border rounded-lg overflow-hidden transition-all hover:shadow-md",r==="list"&&"flex items-center p-4",c.processed&&"ring-2 ring-green-500",d&&x===p&&"ring-2 ring-blue-500 animate-pulse"),children:[e.jsxs("div",{className:I("relative",r==="grid"?"aspect-square":"w-16 h-16 flex-shrink-0"),children:[e.jsx("img",{src:c.preview,alt:`Batch image ${p+1}`,className:"w-full h-full object-cover"}),c.processed&&e.jsx("div",{className:"absolute inset-0 bg-green-500/20 flex items-center justify-center",children:e.jsx(w,{className:"bg-green-500 text-white",children:s("batch.processed")})}),d&&x===p&&e.jsx("div",{className:"absolute inset-0 bg-blue-500/20 flex items-center justify-center",children:e.jsxs(w,{className:"bg-blue-500 text-white animate-pulse",children:[s("batch.processing"),"..."]})})]}),e.jsxs("div",{className:I("p-3",r==="list"&&"flex-1 ml-4"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium truncate",children:c.file.name}),e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>F(c.id),className:"text-destructive hover:text-destructive",children:e.jsx(L,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("div",{children:[(c.file.size/1024/1024).toFixed(2)," MB"]}),c.processed&&c.analysis&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(w,{variant:"outline",className:"text-xs",children:s("batch.analyzed")}),c.downloadUrl&&e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>{const j=document.createElement("a");j.href=c.downloadUrl,j.download=`processed-${c.file.name}`,j.click()},className:"w-full mt-2",children:[e.jsx(R,{className:"w-3 h-3 mr-1"}),s("batch.download")]})]})]})]})]},c.id))})})]})]})}function Pe(){const{t:n}=z(),{trackPageView:s}=_();return K.useEffect(()=>{s("/batch")},[s]),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-amber-50 via-orange-50 to-red-50 dark:from-amber-950 dark:via-orange-950 dark:to-red-950",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx(we,{})})})}export{Pe as BatchPage};
